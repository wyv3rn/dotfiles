#!/usr/bin/env bash

uname=$(uname)

fzf-win() {
    if [ "$uname" == "Darwin" ]; then
        win_id=$(hs -c "MWM.print_all_windows()" | gfzf | awk -F';' '{print $3}')
        hs -c "MWM.focus_window(${win_id})"
    else
        echo "Unimplemented"
        exit -1
    fi
}

focus-or-spawn() {
    winid=`wmctrl -lx | awk -v program=$1 'tolower($3) ~ tolower(program) {print $1}' | head -n1`
    if [ -n "$winid" ]; then
        wmctrl -i -a $winid
    else
        launch $1
    fi
}

case $1 in
    focus-or-spawn)
        shift
        focus-or-spawn "$@"
        ;;
    fzf-win)
        shift
        fzf-win
        ;;
    *)
        echo "Unsupported command $1"
        exit -1
esac

